{"id":"stick-rumble-350","title":"Tech Debt: Split epics.md into separate epic documents","description":"The current epics.md file is too large (~31K tokens) and overwhelms agent context windows when read.\n\n**Problem:**\n- docs/epics.md contains all epics (1-9+) in a single file\n- File exceeds 25K token read limit, requiring offset/limit pagination\n- Agents waste context loading irrelevant epic content\n- Difficult to maintain and update individual epics\n\n**Acceptance Criteria:**\n\n1. Split epics.md into individual epic files:\n   - docs/epics/epic-1-multiplayer-foundation.md\n   - docs/epics/epic-2-core-combat.md\n   - docs/epics/epic-3-weapon-systems.md\n   - docs/epics/epic-4-networked-gameplay.md\n   - (continue for epics 5-9)\n\n2. Create docs/epics/README.md or docs/epics/index.md:\n   - Overview of all epics with status\n   - Links to individual epic files\n   - Quick reference for epic dependencies\n\n3. Keep docs/epics.md as redirect/deprecated notice:\n   - Point to new location\n   - Or delete entirely after migration\n\n4. Update any references to epics.md in codebase:\n   - CLAUDE.md if applicable\n   - Any other documentation\n\n**Expected Result:**\n- Each epic file ~2-4K tokens (easily fits in context)\n- Agents can read only the relevant epic\n- Easier to update progress per-epic\n- Better git history (changes isolated to specific epics)\n\n**Technical Notes:**\n- Current file has 1198+ lines\n- Epic 3 alone spans lines 721-1152 (~430 lines)\n- Consider using consistent frontmatter (status, progress, dates)","notes":"Pull Request: https://github.com/mtomcal/stick-rumble/pull/7","status":"closed","priority":1,"issue_type":"chore","created_at":"2026-01-12T01:17:31.923411025Z","created_by":"mtomcal","updated_at":"2026-01-12T01:48:55.202502967Z","closed_at":"2026-01-12T01:47:35.857984504Z","close_reason":"Full cycle complete: Split epics.md into 11 individual files (9 epic files + README + FR coverage matrix). 2 code review passes (1 broken link fixed), 2 test review passes, all tests passing. Token savings: ~31K tokens down to 2-4K per file."}
{"id":"stick-rumble-3gs","title":"Story 3.3A: Define Weapon Acquisition System","description":"Define and document how players acquire weapons. Choose between random floor spawns, loadout system, or fixed spawn points. Document in GDD.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T01:02:05.090051554Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:47.346873159Z","closed_at":"2026-01-12T01:02:47.346873159Z","close_reason":"Migrated as done from ReadyQ - weapon acquisition system defined"}
{"id":"stick-rumble-3la","title":"Tech Debt: Client-Side Clock Interface (Simulation Phase 1)","description":"Mirror the server's injectable Clock pattern on the client for deterministic testing.\n\n**Research Reference:** research/2026-01-12-headless-game-testing-strategies.md\n\n**Acceptance Criteria:**\n\n1. Create Clock interface in client:\n   - RealClock: uses Date.now() for production\n   - ManualClock: advance(ms) for tests, starts at 0\n\n2. Inject Clock into time-dependent managers:\n   - PlayerManager (respawn timers, invulnerability)\n   - ProjectileManager (lifetime, updates)\n   - WeaponManager (fire rate, reload timers)\n\n3. Update existing tests to use ManualClock:\n   - Replace setTimeout/setInterval mocks with clock.advance()\n   - Ensure deterministic test execution\n\n4. Match server pattern from clock.go:\n   - now(): number (milliseconds)\n   - advance(ms: number): void\n\n**Technical Notes:**\n- Enables instant simulation of game time without real delays\n- Foundation for GameSimulation class (Phase 2)\n- Pattern proven on server: stick-rumble-server/internal/game/clock.go","status":"open","priority":1,"issue_type":"chore","created_at":"2026-01-12T07:00:19.775344552Z","created_by":"mtomcal","updated_at":"2026-01-12T07:00:19.775344552Z","dependencies":[{"issue_id":"stick-rumble-3la","depends_on_id":"stick-rumble-ys4","type":"blocks","created_at":"2026-01-12T07:00:57.998667683Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-3u8","title":"Story 3.0B: Fix Pistol Damage Mismatch","description":"Fix pistol damage mismatch between client (15) and server (25). Change client constant to match server.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-12T01:01:46.895654103Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:47.32241852Z","closed_at":"2026-01-12T01:02:47.32241852Z","close_reason":"Migrated as done from ReadyQ - pistol damage fixed"}
{"id":"stick-rumble-4gv","title":"Improve network package test coverage to \u003e90%","notes":"Current network package coverage: 87.6%. Functions needing coverage: broadcast_helper.go (broadcastWeaponPickup 66.7%, broadcastWeaponRespawn 66.7%, sendShootFailed 75%, onRespawn 75%, onHit 76.6%). Focus on error handling paths and edge cases. This is a pre-existing gap not caused by the JSON schema integration task (stick-rumble-iqu).","status":"open","priority":2,"issue_type":"chore","created_at":"2026-01-12T06:58:30.871154885Z","created_by":"mtomcal","updated_at":"2026-01-12T06:58:36.643031534Z"}
{"id":"stick-rumble-560","title":"Story 3.6: Implement Dodge Roll with Invincibility Frames","description":"Dodge roll with Space. 0.4s duration, 100px distance. First 0.2s invincible. 3s cooldown. Cannot shoot/reload during roll.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-12T01:02:31.953170018Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:31.953170018Z","dependencies":[{"issue_id":"stick-rumble-560","depends_on_id":"stick-rumble-p3x","type":"blocks","created_at":"2026-01-12T01:02:55.306660212Z","created_by":"mtomcal"},{"issue_id":"stick-rumble-560","depends_on_id":"stick-rumble-jtv","type":"blocks","created_at":"2026-01-12T07:01:12.373406349Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-6rj","title":"Story 3.8: Implement Shared Configuration System for Weapon Stats","description":"Single source of truth for weapon stats. JSON config loaded by both client and server. CI validates configs match.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-12T01:02:34.722965389Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:34.722965389Z","dependencies":[{"issue_id":"stick-rumble-6rj","depends_on_id":"stick-rumble-9sc","type":"blocks","created_at":"2026-01-12T01:02:55.377211444Z","created_by":"mtomcal"},{"issue_id":"stick-rumble-6rj","depends_on_id":"stick-rumble-ys4","type":"blocks","created_at":"2026-01-12T01:37:36.334772646Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-73b","title":"Story 3.0: Weapon Balance Research \u0026 Validation","description":"Validate weapon balance across all 5 weapons before implementation. Create DPS calculations, TTK analysis, and risk/reward trade-off matrix. See docs/weapon-balance-analysis.md.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T01:02:04.373433308Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:47.298095813Z","closed_at":"2026-01-12T01:02:47.298095813Z","close_reason":"Migrated as done from ReadyQ - weapon balance research complete"}
{"id":"stick-rumble-8e2","title":"Tech Debt: Research and fix chatty integration test logs","description":"Integration tests produce verbose output overwhelming agent context windows. Investigate sources and reduce log verbosity.","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-12T01:02:35.504305236Z","created_by":"mtomcal","updated_at":"2026-01-12T01:16:12.931194898Z","closed_at":"2026-01-12T01:16:12.931194898Z","close_reason":"Split into two focused issues: stick-rumble-dxm (Client/Vitest) and stick-rumble-pkc (Server/Go) for parallel implementation"}
{"id":"stick-rumble-9sc","title":"Story 3.4: Implement Manual Reload Mechanic","description":"Manual reload with R key. Weapon-specific reload times. Progress bar, auto-reload on empty, can cancel by switching weapons. Can move during reload.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-12T01:02:18.874118632Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:18.874118632Z","dependencies":[{"issue_id":"stick-rumble-9sc","depends_on_id":"stick-rumble-9w1","type":"blocks","created_at":"2026-01-12T01:02:55.260061943Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-9tb","title":"Tech Debt: Input Recording \u0026 Scenario Replay (Simulation Phase 3)","description":"Implement input recording at client and scenario replay for deterministic testing.\n\n**Research Reference:** research/2026-01-12-headless-game-testing-strategies.md\n\n**Acceptance Criteria:**\n\n1. Create InputRecorder class:\n   - record(tick, playerId, input): void\n   - getRecording(): InputFrame[]\n   - saveToJSON(path): void\n   - loadFromJSON(path): InputFrame[]\n\n2. Create ScenarioRunner class:\n   - run(scenario, assertions): TestResult[]\n   - Replay recorded inputs deterministically\n   - Check assertions at specified ticks\n\n3. Define Scenario file format (JSON):\n   - name: string\n   - players: [{id, startPosition}]\n   - inputs: [{tick, playerId, input}]\n   - duration: number (ticks)\n\n4. Add input logging to WebSocketClient:\n   - Log all outgoing input:state messages (dev mode only)\n   - Include timestamp and frame number\n   - Toggle via environment variable\n\n5. Create example scenario tests:\n   - Two players face-off combat\n   - Player movement to all corners\n   - Weapon pickup race\n\n**Technical Notes:**\n- Input recording happens BEFORE network send (client-side)\n- Enables bug reproduction from player recordings\n- Scenario files stored in tests/scenarios/*.json","status":"open","priority":1,"issue_type":"chore","created_at":"2026-01-12T07:00:39.754788031Z","created_by":"mtomcal","updated_at":"2026-01-12T07:00:39.754788031Z","dependencies":[{"issue_id":"stick-rumble-9tb","depends_on_id":"stick-rumble-q5b","type":"blocks","created_at":"2026-01-12T07:00:59.71512872Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-9w1","title":"Story 3.3: Implement Ranged Weapons (Uzi, AK47, Shotgun)","description":"Implement ranged weapons. Uzi: 8 dmg, 10 rps, 600px range. AK47: 20 dmg, 6 rps, 800px range. Shotgun: 60 dmg spread. Recoil and spread mechanics.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-12T01:02:18.106961924Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:18.106961924Z","dependencies":[{"issue_id":"stick-rumble-9w1","depends_on_id":"stick-rumble-fkh","type":"blocks","created_at":"2026-01-12T01:02:55.233632933Z","created_by":"mtomcal"},{"issue_id":"stick-rumble-9w1","depends_on_id":"stick-rumble-ys4","type":"blocks","created_at":"2026-01-12T01:37:30.196562397Z","created_by":"mtomcal"},{"issue_id":"stick-rumble-9w1","depends_on_id":"stick-rumble-jtv","type":"blocks","created_at":"2026-01-12T07:01:10.592888964Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-b05","title":"Tech Debt: JSON Schema Client Integration (Phase 2)","description":"Integrate JSON Schema validation into the TypeScript client.\n\n**Research Reference:** research/2026-01-12-json-schema-websocket-validation.md\n\n**Acceptance Criteria:**\n\n1. Define all client→server message schemas in TypeBox:\n   - input:state {up, down, left, right: bool, aimAngle: number}\n   - player:shoot {aimAngle: number}\n   - player:reload (no data)\n   - weapon:pickup_attempt {crateId: string}\n\n2. Add validation to WebSocketClient.ts send methods:\n   - Compile AJV validators at module load\n   - Validate outgoing messages before send\n   - Log validation errors in development\n\n3. Generate JSON Schema files from TypeBox:\n   - Build script outputs to schemas/client-to-server/*.json\n   - CI validates generated files are up-to-date\n\n4. Update test helpers to use schema validation:\n   - Integration test helpers validate message format\n   - Consider json-schema-faker for test data generation\n\n**Technical Notes:**\n- Client validation is for DX, not security (server is authoritative)\n- Pre-compile validators for performance\n- See research doc for AJV integration example","notes":"Pull Request: https://github.com/mtomcal/stick-rumble/pull/9","status":"closed","priority":1,"issue_type":"chore","created_at":"2026-01-12T01:37:14.832373174Z","created_by":"mtomcal","updated_at":"2026-01-12T06:24:07.45463363Z","closed_at":"2026-01-12T06:24:07.45463363Z","close_reason":"PR #9 merged - JSON Schema Client Integration complete","dependencies":[{"issue_id":"stick-rumble-b05","depends_on_id":"stick-rumble-dcz","type":"blocks","created_at":"2026-01-12T01:37:22.810855891Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-cdq","title":"Story 3.4A: Define Ammo Economy \u0026 Magazine Balance","description":"Define ammo economy system. Document magazine sizes, reload times, and ammo scarcity decisions. Update GDD Section 2.3.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T01:02:05.893130104Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:47.370940802Z","closed_at":"2026-01-12T01:02:47.370940802Z","close_reason":"Migrated as done from ReadyQ - ammo economy defined"}
{"id":"stick-rumble-dcz","title":"Tech Debt: JSON Schema Setup (Phase 1)","description":"Create events-schema/ directory structure with TypeBox + AJV setup.\n\n**Research Reference:** research/2026-01-12-json-schema-websocket-validation.md\n\n**Acceptance Criteria:**\n\n1. Create events-schema/ directory structure:\n   - events-schema/schemas/common.json (Position, Velocity types)\n   - events-schema/schemas/client-to-server/\n   - events-schema/schemas/server-to-client/\n   - events-schema/generated/typescript/\n   - events-schema/generated/go/\n   - events-schema/package.json\n   - events-schema/src/ (TypeBox definitions)\n\n2. Add dependencies:\n   - @sinclair/typebox\n   - ajv\n   - ts-node (dev)\n\n3. Create Makefile targets:\n   - schema-generate: Build schemas from TypeBox\n   - schema-validate: Validate all schemas\n\n4. Define common types in TypeBox:\n   - Position {x: number, y: number}\n   - Velocity {x: number, y: number}\n   - Base Message wrapper schema\n\n5. Add events-schema build to root Makefile\n\n**Technical Notes:**\n- TypeBox schemas ARE valid JSON Schema (no conversion needed)\n- Use $id for schema identification\n- See research doc for example TypeBox definitions","notes":"Pull Request: https://github.com/mtomcal/stick-rumble/pull/8","status":"closed","priority":1,"issue_type":"chore","created_at":"2026-01-12T01:37:13.685835038Z","created_by":"mtomcal","updated_at":"2026-01-12T02:07:51.943509752Z","closed_at":"2026-01-12T02:06:38.452635858Z","close_reason":"Full implementation complete: events-schema/ directory with TypeBox + AJV setup, Position/Velocity/Message schemas, build/validate scripts, Makefile integration. 2 code review passes (fixed ESM import issue, improved test coverage). 2 test review passes (no issues). 72 tests, 100% statement coverage, 91.66% branch coverage. All typecheck/lint/tests pass."}
{"id":"stick-rumble-dxm","title":"Tech Debt: Reduce Client Test Verbosity (Vitest)","description":"Reduce Vitest test output to prevent overwhelming agent context windows.\n\n**Research:** See research/2025-12-10-reduce-test-verbosity.md\n\n**Acceptance Criteria:**\n\n1. Update vitest.config.ts:\n   - Add reporters: ['dot']\n   - Add silent: 'passed-only'\n   - Change coverage reporter from ['text', 'html', 'json-summary'] to ['json-summary', 'html']\n\n2. Update vitest.integration.config.ts:\n   - Add reporters: ['dot']\n   - Add silent: 'passed-only'\n\n3. Update package.json test scripts:\n   - Add --reporter=dot --silent=passed-only flags\n\n4. (Optional Phase 2) Gate integration helper logging:\n   - Add VITEST_VERBOSE_INTEGRATION env var check to WebSocketClient.integration.helpers.ts\n   - Replace console.log calls with conditional log function\n\n**Expected Result:** ~80-85% reduction in client test output tokens (from ~50-80K to ~5-10K per run)\n\n**Technical Notes:**\n- Zero code changes for Phase 1 (config only)\n- 12 console statements in integration helpers (lines 156-355)\n- 8 console statements in WebSocketClient.ts (lines 43-142)\n- Vitest 4.0.13 supports silent: 'passed-only' mode","notes":"Pull Request: https://github.com/mtomcal/stick-rumble/pull/5","status":"closed","priority":1,"issue_type":"chore","created_at":"2026-01-12T01:15:30.852382366Z","created_by":"mtomcal","updated_at":"2026-01-12T01:34:53.42752277Z","closed_at":"2026-01-12T01:33:48.451168533Z","close_reason":"Full cycle complete: Implementation, 2 code review passes, 2 test review passes. All acceptance criteria met - vitest.config.ts and vitest.integration.config.ts updated with dot reporter and silent mode, package.json test scripts updated. ~80% reduction in test output."}
{"id":"stick-rumble-ee2","title":"Tech Debt: Research JSON Schema for WebSocket Event Payloads","description":"Research creating a shared events-schema directory using JSON Schema for WebSocket event validation across client (TypeScript) and server (Go).\n\n**Problem:**\n- WebSocket event payloads are defined separately in client and server\n- No shared source of truth for message structure\n- Testing requires manual payload construction without validation\n- Mismatches between client/server event structures cause runtime bugs\n\n**Research Questions:**\n\n1. **JSON Schema tooling for TypeScript:**\n   - How to generate TypeScript types from JSON Schema?\n   - Options: json-schema-to-typescript, zod-to-json-schema, ajv\n   - Runtime validation vs compile-time types\n\n2. **JSON Schema tooling for Go:**\n   - How to generate Go structs from JSON Schema?\n   - Options: go-jsonschema, quicktype, gojsonschema\n   - Runtime validation libraries (gojsonschema, jsonschema)\n\n3. **Directory structure:**\n   - Where to place shared schemas? (root events-schema/, shared/, etc.)\n   - Naming conventions for event schemas\n   - Versioning strategy\n\n4. **Build integration:**\n   - How to integrate schema generation into build process?\n   - CI validation that generated code matches schemas\n   - Watch mode for development\n\n5. **Current event types to document:**\n   - room:joined, player:left\n   - input:state, player:move\n   - weapon:pickup_attempt, weapon:pickup_confirmed, weapon:respawned\n   - test message type\n\n**Deliverables:**\n- Research document in research/ directory\n- Recommendation for tooling choices\n- Proposed directory structure\n- Example schema for one event type\n- Integration approach for Makefile\n\n**Out of Scope (for this research issue):**\n- Actual implementation of all schemas\n- Migration of existing code to use schemas\n\n**Technical Context:**\n- Current message format: {type: string, timestamp: number, data?: unknown}\n- Client: src/game/network/WebSocketClient.ts\n- Server: internal/network/websocket_handler.go\n- Message types defined in CLAUDE.md","status":"closed","priority":1,"issue_type":"chore","created_at":"2026-01-12T01:19:48.200843539Z","created_by":"mtomcal","updated_at":"2026-01-12T01:27:08.246824737Z","closed_at":"2026-01-12T01:27:08.246824737Z","close_reason":"Research complete. Documented in research/2026-01-12-json-schema-websocket-validation.md. Key recommendations: (1) TypeBox + AJV for TypeScript client - TypeBox schemas ARE valid JSON Schema with full type inference, AJV is 5-18x faster than Zod. (2) kaptinlin/jsonschema for Go server - supports Draft 2020-12, zero-copy validation. (3) Proposed events-schema/ directory structure with TypeBox definitions that compile to JSON Schema. (4) 4-phase integration approach: setup, client integration, server integration, server-to-client messages. All 16 message types documented with data structures and file references."}
{"id":"stick-rumble-fkh","title":"Story 3.2: Implement Melee Weapons (Bat and Katana)","description":"Implement melee combat. Bat: 25 dmg, 0.5s cooldown, 64px range. Katana: 45 dmg, 0.8s cooldown, 80px range. Knockback, sound effects, screen shake.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-12T01:02:17.306806992Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:17.306806992Z","dependencies":[{"issue_id":"stick-rumble-fkh","depends_on_id":"stick-rumble-xxk","type":"blocks","created_at":"2026-01-12T01:02:55.209444881Z","created_by":"mtomcal"},{"issue_id":"stick-rumble-fkh","depends_on_id":"stick-rumble-ys4","type":"blocks","created_at":"2026-01-12T01:39:07.486849064Z","created_by":"mtomcal"},{"issue_id":"stick-rumble-fkh","depends_on_id":"stick-rumble-jtv","type":"blocks","created_at":"2026-01-12T07:01:09.813564941Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-gxw","title":"Story 3.7B: Health Bars \u0026 Hit Effects","description":"Health bar UI (32x4, green bar), bullet impact flash, melee hit lines, muzzle flash. Visual feedback during combat.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-12T01:02:34.006317074Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:34.006317074Z","dependencies":[{"issue_id":"stick-rumble-gxw","depends_on_id":"stick-rumble-yto","type":"blocks","created_at":"2026-01-12T01:02:55.354299201Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-iqu","title":"Tech Debt: JSON Schema Server Integration (Phase 3)","description":"Integrate JSON Schema validation into the Go server.\n\n**Research Reference:** research/2026-01-12-json-schema-websocket-validation.md\n\n**Acceptance Criteria:**\n\n1. Add kaptinlin/jsonschema dependency:\n   - go get github.com/kaptinlin/jsonschema\n   - Supports JSON Schema Draft 2020-12\n\n2. Load JSON Schema files at server startup:\n   - Compile schemas from events-schema/schemas/client-to-server/\n   - Cache compiled validators\n   - Fatal error if schemas fail to load\n\n3. Add validation to message_processor.go:\n   - Validate incoming message data against schema\n   - Replace manual type assertions (getBool, getFloat64, getString)\n   - Maintain graceful degradation for missing optional fields\n\n4. Keep explicit NaN/Infinity checks:\n   - JSON Schema cannot validate NaN\n   - Retain checks in broadcast_helper.go:19-34\n\n**Technical Notes:**\n- Zero-copy validation without JSON marshaling\n- Pre-compile all schemas for 20Hz game tick performance\n- Log validation errors server-side, don't expose to clients","notes":"Pull Request: https://github.com/mtomcal/stick-rumble/pull/12","status":"closed","priority":1,"issue_type":"chore","created_at":"2026-01-12T01:37:16.175088857Z","created_by":"mtomcal","updated_at":"2026-01-12T07:35:04.531532821Z","closed_at":"2026-01-12T07:35:04.531532821Z","close_reason":"PR #12 merged - JSON Schema Server Integration complete","dependencies":[{"issue_id":"stick-rumble-iqu","depends_on_id":"stick-rumble-b05","type":"blocks","created_at":"2026-01-12T01:37:23.552879946Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-jtv","title":"Tech Debt: UI Regression Testing (Simulation Phase 4)","description":"Implement screenshot-based UI regression testing for visual consistency.\n\n**Research Reference:** research/2026-01-12-headless-game-testing-strategies.md\n\n**Acceptance Criteria:**\n\n1. Setup Playwright for visual regression:\n   - npm install @playwright/test\n   - Configure for headless Chrome\n   - Screenshot comparison with pixel diff\n\n2. Create UI test scenarios:\n   - Health bar at various HP levels (100%, 50%, 10%, 0%)\n   - Weapon HUD for each weapon type\n   - Reload progress bar states\n   - Kill feed display\n\n3. Baseline screenshot management:\n   - Store baselines in tests/screenshots/baseline/\n   - Generate diff images on failure\n   - CI fails on visual regression \u003e1% pixel diff\n\n4. Test commands:\n   - npm run test:visual - run visual regression\n   - npm run test:visual:update - update baselines\n\n5. Integration with CI:\n   - Run visual tests after unit tests pass\n   - Upload diff images as artifacts on failure\n\n**Technical Notes:**\n- Separate from logic tests (not LLM-driven)\n- Pure pixel comparison, fast execution\n- Only test static UI states, not animations\n- Requires game to render specific test states","status":"open","priority":1,"issue_type":"chore","created_at":"2026-01-12T07:00:48.161796512Z","created_by":"mtomcal","updated_at":"2026-01-12T07:00:48.161796512Z","dependencies":[{"issue_id":"stick-rumble-jtv","depends_on_id":"stick-rumble-9tb","type":"blocks","created_at":"2026-01-12T07:01:00.787319585Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-mjw","title":"Optimize slow server tests by injecting time dependencies","description":"## Problem\n\nServer tests take ~33 seconds to run due to real-time delays in tests. This slows down development feedback loops and CI pipelines.\n\n## Root Cause Analysis\n\nTests use `time.Sleep` with actual game timing constants instead of mocked/injectable time:\n\n### Major time sinks identified:\n- `gameserver_tick_test.go:216`: `time.Sleep(5 * time.Second)` - health regen delay\n- `gameserver_tick_test.go:296`: `time.Sleep(5500 * time.Millisecond)` - health regen after respawn  \n- `gameserver_tick_test.go:277`: `time.Sleep(3500 * time.Millisecond)` - respawn timing\n- `player_test.go:873`: `time.Sleep(3 * time.Second)` - respawn delay\n- `gameserver_shooting_test.go`: Two 1700ms sleeps for reload cooldowns\n- 50+ smaller sleeps (50-100ms each) for async operations\n\n### Slow test breakdown:\n- `TestGameServerHealthRegenerationAfterRespawn`: 9.00s\n- `TestGameServerHealthRegeneration`: 6.10s\n- `TestGameServerRespawn_WeaponStateReset`: 3.10s\n- `TestGameServerReloadCompleteCallback`: 1.70s\n- `TestGameServerReloadCompleteCallback_NoCallback`: 1.70s\n- `TestGameServerPhysicsIntegration`: 1.00s\n\n## Proposed Solutions\n\n1. **Inject a clock interface** - Create a `Clock` interface with `Now()` and `Sleep()` methods. Use real clock in production, fake clock in tests that can be advanced instantly.\n\n2. **Use test-specific timing constants** - Allow tests to override `RespawnDelay`, `HealthRegenDelay`, `ReloadTime` etc. with shorter values.\n\n3. **Replace sleeps with event channels** - Instead of sleeping arbitrary durations, wait for specific events/conditions to occur.\n\n4. **Tag slow tests for optional exclusion** - Use `//go:build slow` build tags so developers can skip slow tests during rapid iteration.\n\n## Expected Outcome\n\nReduce server test runtime from ~33s to \u003c5s while maintaining test coverage and reliability.\n\n## Files to Modify\n\n- `internal/game/gameserver.go` - Add clock injection\n- `internal/game/player.go` - Add clock injection for respawn/regen timing\n- `internal/game/weapon.go` - Add clock injection for reload timing\n- All test files using `time.Sleep`","notes":"Pull Request: https://github.com/mtomcal/stick-rumble/pull/10","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-12T01:58:09.556838989Z","created_by":"mtomcal","updated_at":"2026-01-12T06:33:45.453111111Z","closed_at":"2026-01-12T06:33:45.453111111Z","close_reason":"PR #10 merged. Server test runtime reduced from 33s to 2.8s (91.5% improvement). Coverage 94.1%.","labels":["performance","tech-debt","testing"],"comments":[{"id":1,"issue_id":"stick-rumble-mjw","author":"mtomcal","text":"Starting implementation with TDD approach.\n\nPhase 1: Creating Clock interface in internal/game/clock.go with:\n- Clock interface (Now(), Since() methods)\n- RealClock implementation\n- ManualClock implementation with thread-safety\n\nWill write tests first, then implementation.","created_at":"2026-01-12T03:15:21Z"},{"id":2,"issue_id":"stick-rumble-mjw","author":"mtomcal","text":"Implementation complete - Time injection successfully reduces test runtime from ~33s to 2.8s (91.5% improvement)\n\nCHANGES IMPLEMENTED:\n\n1. Created Clock interface (internal/game/clock.go):\n   - Clock interface with Now() and Since() methods\n   - RealClock for production use\n   - ManualClock for testing with Advance() and SetTime() methods\n   - Thread-safe implementation with RWMutex\n\n2. Injected Clock into core game components:\n   - GameServer: Added clock field, updated constructor (NewGameServerWithClock)\n   - PlayerState: Added clock for respawn, invulnerability, and health regen timing\n   - WeaponState: Added clock for fire rate cooldowns and reload timing\n   - World: Added clock to propagate to player creation\n\n3. Updated all time-dependent operations:\n   - Replaced time.Now() with clock.Now() in 15+ locations\n   - Replaced time.Since() with clock.Since() in 5+ locations\n   - All game timing now uses injected clock\n\n4. Optimized test files (removed time.Sleep, added simulateTick helpers):\n   - gameserver_tick_test.go: 2 major tests (9s + 6s saved)\n   - gameserver_shooting_test.go: 2 reload tests (3.4s saved)\n   - gameserver_player_test.go: 1 respawn test (3.1s saved)\n   - player_test.go: 4 tests (8s saved)\n\nTEST RESULTS:\n- Runtime: 32.5s → 2.8s (91.5% reduction, exceeded \u003c5s goal)\n- Coverage: 94.1% (exceeds \u003e90% requirement)\n- Linting: go vet passes, gofmt clean\n- All tests passing\n\nFILES MODIFIED:\n- internal/game/clock.go (new)\n- internal/game/clock_test.go (new)\n- internal/game/gameserver.go\n- internal/game/player.go\n- internal/game/weapon.go\n- internal/game/world.go\n- internal/game/gameserver_tick_test.go\n- internal/game/gameserver_shooting_test.go\n- internal/game/gameserver_player_test.go\n- internal/game/player_test.go\n\nDEFERRED WORK:\n- WeaponCrate and WeaponCrateManager clock injection (not critical for current test suite)\n- Some tests still use Start() with real tickers (acceptable performance)","created_at":"2026-01-12T03:30:13Z"},{"id":3,"issue_id":"stick-rumble-mjw","author":"mtomcal","text":"Code review complete (PASS 1 of 2).\n\nFINDINGS: All acceptance criteria EXCEEDED (2.8s vs \u003c5s goal, 94.1% coverage vs \u003e90% requirement). Code quality: Excellent - clean interface design, proper thread safety, Go idioms followed.\n\nVERIFICATION: go vet PASS, gofmt PASS, all tests PASS, coverage 94.1%, runtime 2.8s (91.5% reduction from 33s).\n\nNO ISSUES FOUND - Implementation is production-ready.","created_at":"2026-01-12T03:34:08Z"},{"id":4,"issue_id":"stick-rumble-mjw","author":"mtomcal","text":"FINAL CODE REVIEW (PASS 2/2) COMPLETE - PRODUCTION READY\n\nEDGE CASES VERIFIED:\n✓ Zero time handling: LastShotTime.IsZero() check prevents nil time bugs (weapon.go:92)\n✓ Negative time advancement: ManualClock supports backward time travel for edge case testing\n✓ Thread safety: Race detector passes on concurrent clock access (100 goroutines × 100 iterations)\n✓ Nil pointer safety: DeathTime uses *time.Time (nullable) for proper dead/alive state tracking\n✓ Boundary conditions: Invulnerability checks use After() not \u003e= for precise timing\n\nBACKWARD COMPATIBILITY VERIFIED:\n✓ NewGameServer() unchanged - delegates to NewGameServerWithClock(broadcastFunc, \u0026RealClock{})\n✓ NewPlayerState() unchanged - delegates to NewPlayerStateWithClock(id, \u0026RealClock{})\n✓ NewWeaponState() unchanged - delegates to NewWeaponStateWithClock(weapon, \u0026RealClock{})\n✓ NewWorld() unchanged - delegates to NewWorldWithClock(\u0026RealClock{})\n✓ Production code (websocket_handler.go:52) uses NewGameServer() - no changes needed\n✓ All existing tests using NewGameServer() continue to work without modification\n✓ API design: Existing functions preserved, new *WithClock variants added for DI\n\nRACE CONDITIONS CHECKED:\n✓ ManualClock uses sync.RWMutex for all operations (read-locked Now/Since, write-locked Advance/SetTime)\n✓ RealClock is stateless - no race conditions possible\n✓ PlayerState clock field is read-only after creation - safe for concurrent access\n✓ GameServer clock propagates correctly: GameServer → World → PlayerState (single assignment path)\n✓ go test -race passes on TestManualClock_ThreadSafety\n\nAPI DESIGN REVIEW:\n✓ Clock interface minimal (Now, Since) - follows YAGNI principle\n✓ ManualClock provides Advance() and SetTime() for flexible test scenarios\n✓ Constructor pattern: New*() → real clock, New*WithClock() → injectable (clean separation)\n✓ No exported clock fields - encapsulation preserved\n✓ Thread-safe by design (RWMutex in ManualClock, stateless RealClock)\n\nACCEPTANCE CRITERIA STATUS:\n✓ Test runtime: 2.8s actual vs \u003c5s goal (44% under target, 91.5% improvement from 33s)\n✓ Coverage: 94.1% vs \u003e90% requirement (exceeds by 4.1 percentage points)\n✓ Linting: go vet clean, gofmt clean\n✓ Type checking: All tests pass\n✓ Maintainability: Clock interface enables future timing features without code changes\n\nOUTSTANDING MINOR ISSUES (NON-BLOCKING):\n- Some tests still use time.Sleep (weapon_test.go lines 70, 164, 229, 233) but these are for RealClock tests where actual time passage is intentional\n- TestGameServerPhysicsIntegration still takes 1.00s (uses real tickers via Start()) - acceptable as it tests real-world game loop behavior\n- WeaponCrate/WeaponCrateManager don't have clock injection yet (deferred, not in critical path for current test suite)\n\nPRODUCTION READINESS: ✅ APPROVED\n- No breaking changes\n- All tests pass (100% pass rate)\n- Code quality gates passed\n- Performance goals exceeded\n- No security concerns\n- Thread-safe implementation\n- Clean API design\n\nRECOMMENDATION: Ready to merge. Implementation exceeds all acceptance criteria and follows Go best practices.","created_at":"2026-01-12T03:37:14Z"},{"id":5,"issue_id":"stick-rumble-mjw","author":"mtomcal","text":"TEST REVIEW (PASS 1 of 2) - FINDINGS:\n\nASSERTION QUALITY: ✓ EXCELLENT\n- All assertions match test intent (153 assertions reviewed)\n- No trivial assertions found\n- Assertions specific and meaningful\n- Error messages clearly describe expected vs actual\n\nTEST COVERAGE: ✓ EXCEEDS REQUIREMENTS\n- Current: 94.1% (internal/game), 87.5% (internal/network)\n- Requirement: \u003e90%\n- Exceeds by 4.1 percentage points on game package\n\nTEST PERFORMANCE: ✓ EXCEPTIONAL\n- Runtime: 2.8s (91.5% reduction from 33s)\n- Previously slow tests now instant\n\nTHREAD SAFETY: ✓ VERIFIED\n- go test -race passes\n- 100 concurrent readers + writers tested\n\nEDGE CASES: ✓ COVERED\n- Zero time, negative advancement, boundary conditions, overkill damage, thread safety all tested\n\nREMAINING time.Sleep: ✓ ACCEPTABLE\n- 13 instances found, all intentional for RealClock testing\n- NOT in critical path\n\nCODE QUALITY: ✓ PASSING\n- go vet: PASS\n- gofmt: PASS\n- Test organization: Excellent\n\nNO ISSUES FOUND. Implementation production-ready.","created_at":"2026-01-12T06:16:06Z"},{"id":6,"issue_id":"stick-rumble-mjw","author":"mtomcal","text":"TEST REVIEW PASS 2 COMPLETE (FINAL):\n\nFOCUS AREAS VERIFIED:\n1. Test Isolation: ✓ EXCELLENT\n2. Cleanup/Teardown: ✓ PROPER\n3. Mock Usage: ✓ APPROPRIATE\n4. ManualClock Patterns: ✓ CORRECT\n5. Remaining time.Sleep: ✓ ACCEPTABLE\n\nDETAILED FINDINGS:\n\n1. TEST ISOLATION - EXCELLENT:\n   - No shared global state between tests\n   - Each test creates fresh instances (NewGameServer, NewPlayerState, etc.)\n   - Race detector passes on 5 consecutive runs (go test -race -count=5)\n   - No test dependencies - tests can run in any order\n   - All test functions are independent with local variables\n\n2. CLEANUP/TEARDOWN - PROPER:\n   - All tests using Start() properly call defer cancel() to cleanup goroutines\n   - Context cancellation properly stops ticker loops\n   - GameServer.Stop() called after cancel to ensure cleanup\n   - No leaked goroutines (verified by race detector)\n   - Tests using real-time tickers (TestGameServerPhysicsIntegration, etc.) properly cleanup\n   - Locations: gameserver_tick_test.go:56,102,131,177 / gameserver_player_test.go:33 / gameserver_sync_test.go:33,81\n\n3. MOCK USAGE - APPROPRIATE:\n   - ManualClock used for time-dependent tests (health regen, respawn, reload)\n   - RealClock used for integration tests requiring actual timing behavior\n   - Broadcast callbacks properly mocked with sync.Mutex for thread safety\n   - No unnecessary mocking - keeps tests realistic where appropriate\n\n4. MANUALCLOCK PATTERNS - CORRECT:\n   - Proper constructor usage: NewManualClock(time.Now()) for base time\n   - clock.Advance() used for time progression instead of time.Sleep\n   - simulateTick helpers properly advance clock AND call game methods\n   - Thread-safe usage verified (TestManualClock_ThreadSafety with 100 goroutines)\n   - Injected via *WithClock constructors (NewGameServerWithClock, NewPlayerStateWithClock, etc.)\n   - Clock.Since() used correctly in all time comparisons\n   - Zero time checks (LastShotTime.IsZero()) prevent nil time bugs\n\n5. REMAINING time.Sleep CALLS - ACCEPTABLE:\n   - Total: 13 instances across 6 test files\n   - ALL ARE INTENTIONAL for RealClock testing:\n     * clock_test.go:24 - Tests RealClock.Since() with actual time (REQUIRED)\n     * weapon_test.go:70,164,229,233 - Tests RealClock fire rate cooldowns (REQUIRED)\n     * gameserver_tick_test.go:62,136,182 - Integration tests using Start() with real tickers (ACCEPTABLE)\n     * gameserver_player_test.go:43 - Integration test with real ticker (ACCEPTABLE)\n     * gameserver_sync_test.go:38 - Broadcast timing test (ACCEPTABLE)\n     * match_test.go:41 - Real time test (ACCEPTABLE)\n     * player_test.go:1174 - Small delay for time progression test (ACCEPTABLE)\n   - NOT in critical path tests (health regen, respawn tests use ManualClock)\n   - Do NOT need replacement - these test real-world behavior\n\nTEST PERFORMANCE:\n- Runtime: 2.8s (cached), 15.4s with -race -count=5\n- 91.5% improvement from original 33s baseline\n- Coverage: 94.1% (exceeds \u003e90% requirement)\n\nRACE CONDITIONS:\n- go test -race -count=5 PASSES\n- No data races detected\n- Thread-safe implementations verified\n\nCODE QUALITY:\n- go vet: CLEAN\n- gofmt: CLEAN\n- All tests PASSING\n\nNO ISSUES FOUND - Tests are production-ready and follow best practices.","created_at":"2026-01-12T06:18:29Z"}]}
{"id":"stick-rumble-p3x","title":"Story 3.5: Implement Sprint Mechanic","description":"Sprint with Shift key. 1.5x speed (200-\u003e300 px/s), accuracy penalty (+50% spread), louder footsteps. No stamina limit.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-12T01:02:19.936012994Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:19.936012994Z","dependencies":[{"issue_id":"stick-rumble-p3x","depends_on_id":"stick-rumble-jtv","type":"blocks","created_at":"2026-01-12T07:01:11.311157139Z","created_by":"mtomcal"},{"issue_id":"stick-rumble-p3x","depends_on_id":"stick-rumble-9sc","type":"blocks","created_at":"2026-01-12T07:05:08.366319894Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-pkc","title":"Tech Debt: Reduce Server Test Verbosity (Go)","description":"Reduce Go test output to prevent overwhelming agent context windows.\n\n**Research:** See research/2025-12-10-reduce-test-verbosity.md\n\n**Acceptance Criteria:**\n\n1. Update Makefile test-server target (line 78):\n   - Remove -v flag from go test command\n   - Change from: cd stick-rumble-server \u0026\u0026 go test ./... -v\n   - Change to: cd stick-rumble-server \u0026\u0026 go test ./...\n\n2. Verify coverage script already optimal:\n   - scripts/check-coverage.sh:12 runs without -v (confirmed good)\n\n3. (Optional) Add verbose target for debugging:\n   - Add test-server-verbose target with -v flag for manual debugging\n\n**Expected Result:** ~85% reduction in server test output tokens (from ~30-50K to ~3-5K per run)\n\n**Technical Notes:**\n- Go tests silent by default (without -v), verbose on demand\n- Zero t.Log() calls in test files (good pattern)\n- 271 test functions across 28 test files\n- Makefile inconsistency: 'test' target quiet, 'test-server' verbose","notes":"Pull Request: https://github.com/mtomcal/stick-rumble/pull/6","status":"closed","priority":1,"issue_type":"chore","created_at":"2026-01-12T01:15:51.487196318Z","created_by":"mtomcal","updated_at":"2026-01-12T01:36:10.521918364Z","closed_at":"2026-01-12T01:34:53.481258235Z","close_reason":"Full cycle complete: Removed -v flag from test-server target, added test-server-verbose for debugging, updated CLAUDE.md documentation. Output reduced from ~1341 lines to 4 lines (~99.7% reduction). 2 code reviews + 2 test reviews passed. All acceptance criteria met."}
{"id":"stick-rumble-q5b","title":"Tech Debt: GameSimulation Class (Simulation Phase 2)","description":"Create pure logic GameSimulation class for headless client testing.\n\n**Research Reference:** research/2026-01-12-headless-game-testing-strategies.md\n\n**Acceptance Criteria:**\n\n1. Create GameSimulation class with pure logic (no Phaser):\n   - addPlayer(id, position): void\n   - updateInput(playerId, input): void\n   - tick(deltaMs): void\n   - getPlayerState(id): PlayerState\n   - getAllPlayers(): PlayerState[]\n\n2. Extract physics from PlayerManager into testable functions:\n   - updatePlayerPhysics(player, dt): pure math\n   - checkCollisions(): pure geometry\n   - Reuse existing physics.ts patterns from server\n\n3. Add event callbacks for assertions:\n   - onHit(callback): register hit event listener\n   - onDeath(callback): register death event listener\n   - onWeaponPickup(callback): register pickup listener\n\n4. Create simulateTicks() helper (mirror server pattern):\n   - Run N ticks instantly with ManualClock\n   - Pattern from gameserver_tick_test.go:12-32\n\n5. Unit tests with \u003e90% coverage:\n   - Player movement in all directions\n   - Projectile-player collision detection\n   - Weapon cooldowns and reload\n\n**Technical Notes:**\n- GameSimulation is the client equivalent of GameServer\n- No Phaser imports - pure TypeScript/math\n- Enables 1000s of game ticks to run in milliseconds","status":"open","priority":1,"issue_type":"chore","created_at":"2026-01-12T07:00:30.463103702Z","created_by":"mtomcal","updated_at":"2026-01-12T07:00:30.463103702Z","dependencies":[{"issue_id":"stick-rumble-q5b","depends_on_id":"stick-rumble-3la","type":"blocks","created_at":"2026-01-12T07:00:58.870779493Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-xxk","title":"Story 3.1: Implement Weapon Pickup System","description":"Implement weapon pickup from map spawns. Player moves within 32px, press E to pick up, server validates and broadcasts. Weapons respawn after 30s.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-12T01:02:06.911246718Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:47.394404728Z","closed_at":"2026-01-12T01:02:47.394404728Z","close_reason":"Migrated as done from ReadyQ - weapon pickup system implemented"}
{"id":"stick-rumble-ys4","title":"Tech Debt: JSON Schema Server→Client Messages (Phase 4)","description":"Define and validate all server→client message schemas.\n\n**Research Reference:** research/2026-01-12-json-schema-websocket-validation.md\n\n**Acceptance Criteria:**\n\n1. Define all server→client message schemas in TypeBox (12 types):\n   - room:joined {playerId}\n   - player:move {players: [{id, position, velocity, health, ...}]}\n   - projectile:spawn {id, ownerId, position, velocity}\n   - projectile:destroy {id}\n   - weapon:state {currentAmmo, maxAmmo, isReloading, canShoot}\n   - shoot:failed {reason}\n   - player:damaged {victimId, attackerId, damage, newHealth, projectileId}\n   - hit:confirmed {victimId, damage, projectileId}\n   - player:death {victimId, attackerId}\n   - player:kill_credit {killerId, victimId, killerKills, killerXP}\n   - player:respawn {playerId, position, health}\n   - match:timer {remainingSeconds}\n   - match:ended {winners, finalScores, reason}\n   - weapon:spawned {crates: [{id, position, weaponType, isAvailable}]}\n   - weapon:pickup_confirmed {playerId, crateId, weaponType, nextRespawnTime}\n   - weapon:respawned {crateId, weaponType, position}\n\n2. Add validation before server broadcast:\n   - Validate outgoing messages in broadcast_helper.go\n   - Development-only validation (skip in production for performance)\n\n3. Update client handlers to use typed data:\n   - GameSceneEventHandlers.ts uses generated types\n   - Remove manual type casting\n\n4. CI validation:\n   - Verify client and server schemas match\n   - Fail build on schema drift\n\n**Technical Notes:**\n- This completes the type-safe event system\n- Future weapon messages will follow this pattern\n- Enables Story 3.8 (Shared Config) to build on this infrastructure","notes":"Phase 4 Implementation Plan:\n\n1. Create server-to-client.ts file with all 16 server→client message schemas using TypeBox\n2. Add comprehensive unit tests for server-to-client schemas\n3. Update build-schemas.ts to include server-to-client schemas\n4. Run schema generation and validation\n5. Update TypeScript type checking and linting to ensure all passes\n6. Run all tests to achieve \u003e90% coverage","status":"open","priority":1,"issue_type":"chore","created_at":"2026-01-12T01:37:17.104900845Z","created_by":"mtomcal","updated_at":"2026-01-12T06:42:15.065128495Z","dependencies":[{"issue_id":"stick-rumble-ys4","depends_on_id":"stick-rumble-iqu","type":"blocks","created_at":"2026-01-12T01:37:24.314781142Z","created_by":"mtomcal"}]}
{"id":"stick-rumble-yto","title":"Story 3.7A: Character \u0026 Weapon Sprites","description":"Create stick figure sprites (16x32), 4-frame walk animation. All 5 weapon sprites with distinct designs. Color customization.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-12T01:02:33.256784025Z","created_by":"mtomcal","updated_at":"2026-01-12T01:02:33.256784025Z","dependencies":[{"issue_id":"stick-rumble-yto","depends_on_id":"stick-rumble-560","type":"blocks","created_at":"2026-01-12T01:02:55.331568896Z","created_by":"mtomcal"},{"issue_id":"stick-rumble-yto","depends_on_id":"stick-rumble-jtv","type":"blocks","created_at":"2026-01-12T07:01:13.099665268Z","created_by":"mtomcal"}]}
